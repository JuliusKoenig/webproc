FROM debian:latest

ENV WEBPROC_PRINT="true"
ENV WEBPROC_USE_PROGRAM_ENTRYPOINT="true"
ENV WEBPROC_JOIN_TERMINAL_ON_CONFIG_ERROR="true"
ENV WEBPROC_CONTAINER_PATH="/usr/local/bin/webproc"
ENV WEBPROC_BASE_DOWNLOAD_URL="https://github.com/jpillora/webproc/releases/download"
ENV WEBPROC_VERSION="0.4.0"
ENV WEBPROC_CONFIG_PATH="/var/lib/webproc"
ENV WEBPROC_CONFIG_FILE_NAME="webproc_config.toml"
ENV WEBPROC_CONFIG_PROGRAM_NAME="no-name-specified"
ENV WEBPROC_CONFIG_PROGRAM_ARGS="['echo', 'no program specified']"
ENV WEBPROC_CONFIG_HOST="0.0.0.0"
ENV WEBPROC_CONFIG_PORT="8080"
ENV WEBPROC_CONFIG_USER=""
ENV WEBPROC_CONFIG_PASSWORD=""
ENV WEBPROC_CONFIG_ALLOWED_IPS="[]"
ENV WEBPROC_CONFIG_LOG="both"
ENV WEBPROC_CONFIG_ON_EXIT="ignore"
ENV WEBPROC_CONFIG_ON_SAVE="restart"
ENV WEBPROC_CONFIG_CONFIGURATION_FILES="[]"
ENV WEBPROC_CONFIG_RESTART_TIMEOUT="30s"
ENV WEBPROC_CONFIG_ADD_TO_CONFIGURATION_FILES="true"

LABEL authors="Julius KÃ¶nig"
LABEL version=$WEBPROC_VERSION

# Add WEBPROC_CONTAINER_PATH to PATH
ENV PATH=$WEBPROC_CONTAINER_PATH:$PATH

VOLUME $WEBPROC_CONFIG_PATH

# Copy scripts
COPY /scripts $WEBPROC_CONTAINER_PATH

# install webproc
RUN webproc_install

# expose port
EXPOSE $WEBPROC_CONFIG_PORT/tcp

ENTRYPOINT webproc false
